{{ define "body-class" }}
    article-page
    {{/* 
        Enable the right sidebar if
            - Widget different from 'TOC' is enabled
            - TOC is enabled and not empty
    */}}
    {{- $HasWidgetNotTOC := false -}}
    {{- $TOCWidgetEnabled := false -}}
    {{- range .Site.Params.widgets.page -}}
        {{- if ne .type "toc" -}}
            {{ $HasWidgetNotTOC = true -}}
        {{- else -}}
            {{ $TOCWidgetEnabled = true -}}
        {{- end -}}
    {{- end -}}

    {{- $TOCManuallyDisabled := eq .Params.toc false -}}
    {{- $TOCEnabled := and (not $TOCManuallyDisabled) $TOCWidgetEnabled -}}
    {{- $hasTOC := ge (len .TableOfContents) 100 -}}
    {{- .Scratch.Set "TOCEnabled" (and $TOCEnabled $hasTOC) -}}
    
    {{- .Scratch.Set "hasWidget" (or $HasWidgetNotTOC (and $TOCEnabled $hasTOC)) -}}
{{ end }}

{{ define "main" }}
    {{ partial "article/article.html" . }}

    {{ if .Params.links }}
        {{ partial "article/components/links" . }}
    {{ end }}

    {{ partial "article/components/related-content" . }}
     
    {{ if not (eq .Params.comments false) }}
        {{ partial "comments/include" . }}
    {{ end }}

    {{ partialCached "footer/footer" . }}

    {{ partialCached "article/components/photoswipe" . }}

    <style>
        /* è®¾ç½®æŒ‰é’®æ ·å¼ */
        #clapButton {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background-color: #fff;
            border: none;
            padding: 10px 20px;
            font-size: 15px;
            border-radius: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            z-index: 999; /* ç¡®ä¿æŒ‰é’®åœ¨æœ€å‰é¢ */
        }
    
        /* è®¾ç½®ç‚¹èµæ•°å­—æ ·å¼ */
        #clapCount {
            font-weight: bold;
            color: #34495E;
        }
    
        /* è®¾ç½®emojiæ¼‚æµ®æ•ˆæœ */
        .clap-emoji {
            position: absolute;
            font-size: 25px;
            color: #f8b8d1;
            animation: floatUp 1s ease-out forwards;
            z-index: 1000; /* ç¡®ä¿emojiåœ¨æŒ‰é’®å‰é¢ */
        }
    
        /* æ§åˆ¶emojiæ¼‚æµ®å’Œå˜æµ…çš„åŠ¨ç”» */
        @keyframes floatUp {
            0% {
                transform: translateY(0);
                opacity: 1;
            }
            50% {
                transform: translateY(-30px);
                opacity: 0.7;
            }
            100% {
                transform: translateY(-60px);
                opacity: 0;
            }
        }
    </style>
    
    <!-- Clap Button -->
    <button id="clapButton">
        ğŸ‘ <span id="clapCount">0</span>
    </button>
    
    <script>
        let claps = localStorage.getItem('claps') || 0;
        document.getElementById("clapCount").innerText = claps;
    
        document.getElementById("clapButton").addEventListener("click", function() {
            claps++;
            localStorage.setItem('claps', claps);
            document.getElementById("clapCount").innerText = claps;
    
            // æ·»åŠ ç‚¹å‡»æŒ‰é’®çš„æ ·å¼æ•ˆæœ
            this.style.backgroundColor = "#f7b200"; // èƒŒæ™¯è‰²å˜ä¸ºç²‰è‰²
            this.style.transform = "scale(1.1)"; // æŒ‰é’®ç¨å¾®æ”¾å¤§
    
            // è·å–æŒ‰é’®çš„ä½ç½®
            const buttonRect = this.getBoundingClientRect();
            
            // æ·»åŠ  emoji åŠ¨ç”»æ•ˆæœ
            let emoji = document.createElement("span");
            emoji.classList.add("clap-emoji");
            emoji.innerText = "ğŸ‘";
            
            // è®¾ç½®emojiçš„ä½ç½®ï¼Œç¡®ä¿å®ƒå‡ºç°åœ¨æŒ‰é’®ä¸Šæ–¹
            emoji.style.left = `${buttonRect.left + buttonRect.width / 2 - 15}px`; // æ°´å¹³å±…ä¸­å¯¹é½
            emoji.style.top = `${buttonRect.top - 30}px`; // åœ¨æŒ‰é’®ä¸Šæ–¹30pxä½ç½®å¼€å§‹
    
            // å°† emoji æ·»åŠ åˆ°é¡µé¢
            document.body.appendChild(emoji);
    
            // åœ¨åŠ¨ç”»ç»“æŸåç§»é™¤ emoji å…ƒç´ 
            setTimeout(() => {
                emoji.remove();
            }, 1000); // åŠ¨ç”»æ—¶é—´éœ€è¦ä¸åŠ¨ç”»æ—¶é•¿ä¸€è‡´
    
            // é‡ç½®æŒ‰é’®æ ·å¼
            setTimeout(() => {
                this.style.backgroundColor = "#fff";
                this.style.transform = "scale(1)";
            }, 300);
        });
    </script>    
{{ end }}

{{ define "right-sidebar" }}
    {{ if .Scratch.Get "hasWidget" }}{{ partial "sidebar/right.html" (dict "Context" . "Scope" "page") }}{{ end}}
{{ end }}



